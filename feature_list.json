[
  {
    "category": "Phase 1: Базовый редактор",
    "description": "Настройка Vite + React + TypeScript + Zustand",
    "steps": [
      "npm create vite создаёт проект",
      "Установлены зависимости: react, zustand, konva, react-konva",
      "TypeScript конфигурация работает",
      "Dev server запускается без ошибок"
    ],
    "passes": true
  },
  {
    "category": "Phase 1: Базовый редактор",
    "description": "Konva.js canvas с viewport (pan/zoom)",
    "steps": [
      "Canvas отображается на странице",
      "Pan: можно перемещать canvas зажав пробел/колёсико",
      "Zoom: колёсико мыши увеличивает/уменьшает масштаб",
      "Zoom центрируется на позиции курсора"
    ],
    "passes": true
  },
  {
    "category": "Phase 1: Базовый редактор",
    "description": "Scene Graph с примитивами (frame, rect, ellipse, text)",
    "steps": [
      "Можно создать Frame",
      "Можно создать Rectangle",
      "Можно создать Ellipse",
      "Можно создать Text",
      "Узлы корректно рендерятся на canvas"
    ],
    "passes": true
  },
  {
    "category": "Phase 1: Базовый редактор",
    "description": "Selection & Transform (move, resize)",
    "steps": [
      "Клик на элемент выделяет его",
      "Выделенный элемент показывает bounding box",
      "Drag перемещает элемент",
      "Resize handles изменяют размер",
      "Множественное выделение работает (Shift+клик)"
    ],
    "passes": true
  },
  {
    "category": "Phase 1: Базовый редактор",
    "description": "Layers Panel (иерархия узлов)",
    "steps": [
      "Панель отображает дерево узлов",
      "Клик выделяет узел на canvas",
      "Drag-n-drop меняет порядок/иерархию",
      "Иконки показывают тип узла",
      "Можно скрыть/показать узел"
    ],
    "passes": true
  },
  {
    "category": "Phase 1: Базовый редактор",
    "description": "Properties Panel (редактирование свойств)",
    "steps": [
      "Панель показывает свойства выделенного узла",
      "Можно изменить позицию (x, y)",
      "Можно изменить размер (width, height)",
      "Можно изменить fill color",
      "Можно изменить stroke color и width",
      "Изменения применяются в реальном времени"
    ],
    "passes": true
  },
  {
    "category": "Phase 1: Базовый редактор",
    "description": "Сохранение/загрузка JSON файлов",
    "steps": [
      "Кнопка Save сохраняет документ в .json",
      "Кнопка Open загружает .json файл",
      "Формат файла соответствует спецификации",
      "После загрузки все узлы восстанавливаются корректно"
    ],
    "passes": true
  },
  {
    "category": "Phase 2: Auto-Layout",
    "description": "Интеграция yoga-layout (WASM)",
    "steps": [
      "yoga-layout установлен и инициализируется",
      "WASM модуль загружается без ошибок",
      "Yoga.Node создаётся для каждого Frame",
      "Layout вычисляется при изменении свойств"
    ],
    "passes": true
  },
  {
    "category": "Phase 2: Auto-Layout",
    "description": "Layout properties в UI (direction, gap, padding, align)",
    "steps": [
      "UI для выбора direction (horizontal/vertical)",
      "Input для gap между элементами",
      "Inputs для padding (top, right, bottom, left)",
      "UI для alignItems (start, center, end, stretch)",
      "UI для justifyContent (start, center, end, space-between)"
    ],
    "passes": true
  },
  {
    "category": "Phase 2: Auto-Layout",
    "description": "fill_container / fit_content sizing",
    "steps": [
      "UI переключатель для режима sizing",
      "fill_container растягивает элемент на всю ширину/высоту",
      "fit_content подстраивает размер под содержимое",
      "Fixed size задаёт фиксированный размер"
    ],
    "passes": true
  },
  {
    "category": "Phase 2: Auto-Layout",
    "description": "Nested auto-layout frames",
    "steps": [
      "Frame внутри Frame корректно вычисляет layout",
      "Изменение вложенного Frame обновляет родителя",
      "Несколько уровней вложенности работают",
      "Смешанные направления (H внутри V) корректны"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Удаление элементов клавишей Backspace/Delete",
    "steps": [
      "Нажатие Backspace/Delete удаляет выделенные элементы",
      "Множественное выделение удаляется за один раз",
      "После удаления selection очищается",
      "Клавиша Escape снимает выделение"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Отображение вложенности в панели Layers",
    "steps": [
      "Вложенные элементы отображаются с отступом",
      "Frame можно развернуть/свернуть (expand/collapse)",
      "Клик на вложенный элемент выделяет его",
      "Drag-n-drop работает между уровнями вложенности"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Отмена и повтор действий (Undo/Redo)",
    "steps": [
      "Cmd/Ctrl+Z отменяет последнее действие",
      "Cmd/Ctrl+Shift+Z повторяет отменённое действие",
      "История сохраняет изменения узлов",
      "История работает для создания, удаления и изменения свойств"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Infinite canvas (бесконечный холст как в Figma)",
    "steps": [
      "Фон canvas не ограничен фиксированным размером",
      "Динамическая сетка отображается на любом уровне зума",
      "Zoom to fit all - кнопка центрирует все элементы",
      "Viewport culling - рендерятся только видимые элементы"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Ограничение перемещения элементов внутри auto-layout frames",
    "steps": [
      "Элементы внутри auto-layout нельзя перемещать свободно",
      "Drag на canvas переупорядочивает элементы (reorder)",
      "Визуальная индикация места вставки при drag",
      "Drag-out из auto-layout frame переводит элемент в свободный режим"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Inline переименование элементов в Layers Panel",
    "steps": [
      "Двойной клик на имени элемента включает режим редактирования",
      "Поле ввода отображается вместо текста",
      "Enter сохраняет новое имя",
      "Escape отменяет редактирование"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Свойство Rotation в Properties Panel",
    "steps": [
      "Поле rotation отображается в Properties Panel",
      "Можно ввести угол поворота в градусах",
      "Элемент поворачивается в реальном времени",
      "Rotation сохраняется в документ"
    ],
    "passes": true
  },
  {
    "category": "Phase 2.5: Editor Enhancements",
    "description": "Inline редактирование текста на canvas",
    "steps": [
      "Двойной клик на текстовом элементе включает режим редактирования",
      "Курсор появляется в тексте",
      "Можно вводить и изменять текст",
      "Клик вне элемента или Escape завершает редактирование"
    ],
    "passes": true
  },
  {
    "category": "Phase 3: Variables & Themes",
    "description": "Variable system (определение переменных)",
    "steps": [
      "Панель Variables отображает список переменных",
      "Можно создать новую переменную",
      "Можно удалить переменную",
      "Переменные сохраняются в документ"
    ],
    "passes": true
  },
  {
    "category": "Phase 3: Variables & Themes",
    "description": "Theme switching (light/dark)",
    "steps": [
      "UI переключатель темы",
      "Переменные имеют значения для разных тем",
      "Переключение темы обновляет все элементы",
      "Темы сохраняются в документ",
      "Темы можно изменить на уровне frame"
    ],
    "passes": true
  },
  {
    "category": "Phase 3: Variables & Themes",
    "description": "Variable picker в properties panel",
    "steps": [
      "При клике на color показывается picker",
      "Picker показывает список переменных",
      "Выбор переменной применяет её к свойству",
      "Элемент показывает имя переменной вместо значения"
    ],
    "passes": true
  },
  {
    "category": "Phase 4: Advanced Editing",
    "description": "Drag-n-drop сортировка элементов внутри auto-layout frame",
    "steps": [
      "Перетаскивание элемента внутри auto-layout frame не выбрасывает его",
      "Визуальная индикация позиции вставки при перетаскивании",
      "Элементы переупорядочиваются при отпускании",
      "Работает для вложенных auto-layout frames"
    ],
    "passes": true
  },
  {
    "category": "Phase 4: Advanced Editing",
    "description": "Отображение названия frame на canvas с inline-редактированием",
    "steps": [
      "Название frame отображается мелким текстом справа от frame",
      "Двойной клик на названии включает режим редактирования",
      "Enter сохраняет новое название",
      "Название обновляется в Layers Panel"
    ],
    "passes": true
  },
  {
    "category": "Phase 4: Advanced Editing",
    "description": "Ширина, выравнивание, высота строки и letter spacing для текста",
    "steps": [
      "Можно задать фиксированную ширину текстового блока, а также делать его по ширине введенного текста",
      "UI для выравнивания текста (left, center, right)",
      "Input для line-height (высота строки)",
      "Input для letter-spacing (межбуквенный интервал)"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Исправление позиции текстового редактора во вложенных auto-layout",
    "steps": [
      "Текстовый редактор корректно позиционируется внутри auto-layout",
      "Работает для вложенных auto-layout фреймов",
      "Учитывает позиции, вычисленные Yoga layout"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Создание компонента клавишей Opt+Cmd+K",
    "steps": [
      "Opt+Cmd+K создаёт компонент из выбранного фрейма",
      "Работает только для фреймов (не для других типов нод)",
      "Не применяется к уже существующим компонентам"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Перемещение нод стрелками клавиатуры внутри auto-layout",
    "steps": [
      "←→ перемещают элемент в horizontal layout",
      "↑↓ перемещают элемент в vertical layout",
      "Стрелки игнорируются для нерелевантного направления layout",
      "Работает только для элементов внутри auto-layout фреймов"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Секция экспорта выделенных элементов в PNG/JPEG",
    "steps": [
      "Секция Export отображается в нижней части Properties Panel",
      "Кнопки для экспорта в PNG и JPEG форматы",
      "Экспорт выделенного элемента или всего canvas если ничего не выделено",
      "Выбор масштаба экспорта (1x, 2x, 3x)",
      "Файл автоматически скачивается с именем элемента"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Высота frame автоматически становится fit_content при включении auto-layout",
    "steps": [
      "При включении auto-layout на frame его sizing.heightMode устанавливается в fit_content",
      "Размер frame подстраивается под содержимое после включения auto-layout",
      "Ширина остаётся фиксированной (текущее поведение)",
      "Соответствует поведению Figma при создании auto-layout"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Плавный зум canvas как в Figma",
    "steps": [
      "Зум анимируется плавно при прокрутке колёсика мыши",
      "Используется easing функция для естественного ощущения",
      "Накопление delta значений при быстрой прокрутке",
      "Зум остаётся центрированным на позиции курсора во время анимации",
      "Ресерч на тему как это можно сделать тут @./claude/zoom_research.md"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Отображение размеров выбранной ноды снизу по центру",
    "steps": [
      "Снизу по центру у выбранной ноды показывать размеры как на скриншоте @./claude/node-sizes.jpg",
      "Элемент отображает ширину и высоту в формате \"width × height\"",
      "Элемент масштабируется также как label",
      "Отображается только для выбранной ноды",
      "Позиционируется по центру нижней границы ноды"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Кнопки выравнивания для множественного выделения нод",
    "steps": [
      "При выборе нескольких нод показываются кнопки выравнивания вверху панели Properties",
      "Группа горизонтального выравнивания: left, center, right",
      "Группа вертикального выравнивания: top, center, bottom",
      "Кнопки отображаются только при множественном выделении (2+ ноды)",
      "Дизайн кнопок соответствует скриншоту @/.claude/alignment.jpg",
      "Клик на кнопку выравнивает все выделенные ноды по выбранному направлению"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Перемещение элементов на холсте стрелками клавиатуры",
    "steps": [
      "Стрелки клавиатуры (←→↑↓) перемещают выделенные элементы на холсте",
      "Работает только для элементов вне auto-layout фреймов",
      "Для элементов внутри auto-layout стрелки сохраняют текущую функцию (перемещение внутри layout)",
      "Shift + стрелки перемещают элементы с большим шагом",
      "Перемещение работает для множественного выделения"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Рамка множественного выделения/прямоугольное выделение нод",
    "steps": [
      "Зажатие левой кнопки мыши на пустом месте canvas начинает выделение",
      "При перетаскивании отображается прямоугольная рамка выделения",
      "Все ноды, пересекающиеся с рамкой, выделяются",
      "Работает в комбинации с Shift+клик для добавления к существующему выделению",
      "Отпускание кнопки мыши завершает выделение"
    ],
    "passes": true
  },
  {
    "category": "Phase 4.5: Bug Fixes & Shortcuts",
    "description": "Режим рисования нод (как в Figma)",
    "steps": [
      "Клик на иконку ноды в панели активирует режим рисования (не вставляет сразу)",
      "Активированная кнопка визуально выделена/подсвечена",
      "После активации курсор меняется на соответствующий режим рисования",
      "Клик и перетаскивание на canvas создаёт ноду с заданными размерами",
      "Escape или повторный клик на активной кнопке отменяет режим рисования",
      "После создания ноды режим рисования выключается"
    ],
    "passes": true
  },
  {
    "category": "Phase 5: Components",
    "description": "Определение компонентов (reusable)",
    "steps": [
      "Любой Frame можно сделать компонентом (reusable: true)",
      "Компоненты визуально отличаются в Layers Panel (иконка/цвет)",
      "Кнопка Create Component в контекстном меню или toolbar",
      "Компоненты сохраняются в документ"
    ],
    "passes": true
  },
  {
    "category": "Phase 5: Components",
    "description": "Создание инстансов (ref nodes)",
    "steps": [
      "Можно создать инстанс компонента (type: ref)",
      "Инстанс отображает содержимое компонента",
      "Изменение компонента обновляет все инстансы",
      "Инстансы визуально отличаются в Layers Panel"
    ],
    "passes": true
  },
  {
    "category": "Phase 5: Components",
    "description": "Переопределение свойств в инстансах (overrides)",
    "steps": [
      "Можно изменить свойства инстанса (x, y, width, height, fill и т.д.)",
      "Переопределённые свойства сохраняются при обновлении компонента",
      "UI показывает какие свойства переопределены",
      "Кнопка Reset override сбрасывает к значению компонента"
    ],
    "passes": true
  },
  {
    "category": "Phase 5: Components",
    "description": "Переопределение вложенных нод (descendants)",
    "steps": [
      "Можно изменить свойства вложенных элементов внутри инстанса",
      "Путь к вложенной ноде через descendants: { childId: { ... } }",
      "Поддержка путей для глубокой вложенности (parent/child/grandchild)",
      "Можно скрыть вложенную ноду (enabled: false)"
    ],
    "passes": true
  },
  {
    "category": "Phase 5: Components",
    "description": "Варианты компонентов (variant refs)",
    "steps": [
      "Инстанс с reusable: true создаёт вариант компонента",
      "Варианты наследуют от базового компонента",
      "Можно создать инстансы от варианта",
      "Цепочка наследования: Component → Variant → Instance"
    ],
    "passes": false
  },
  {
    "category": "Phase 5: Components",
    "description": "Слоты в компонентах (slots)",
    "steps": [
      "Frame внутри компонента можно пометить как slot",
      "slot содержит массив рекомендуемых компонентов",
      "В инстансе можно вставить контент в слот",
      "UI показывает доступные слоты при редактировании инстанса"
    ],
    "passes": false
  },
  {
    "category": "Phase 5: Components",
    "description": "Базовое свойство enabled для скрытия нод",
    "steps": [
      "Добавлен enabled: boolean в BaseNode",
      "enabled: false скрывает ноду при рендеринге",
      "UI переключатель в Properties Panel",
      "Используется для скрытия элементов в инстансах"
    ],
    "passes": false
  }
]
